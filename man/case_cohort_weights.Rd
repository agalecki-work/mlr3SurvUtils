% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/case_cohort_weights.R
\name{case_cohort_weights}
\alias{case_cohort_weights}
\title{Calculate Weights for Case-Cohort Study}
\usage{
case_cohort_weights(
  data,
  subcoh,
  event_or_status,
  sampling_fraction = 0.15,
  method = "Borgan1",
  type = "right",
  censored_level = NULL
)
}
\arguments{
\item{data}{A data frame containing the study data.}

\item{subcoh}{A string specifying the subcohort column (1 = yes, 0 = no).}

\item{event_or_status}{A string specifying the event/status column:
\itemize{
\item For \code{type = "right"}, an event indicator (1 = event, 0 = censored).
\item For \code{type = "mstate"}, a factor indicating status (e.g., censored, events).
}}

\item{sampling_fraction}{Proportion of cohort sampled (0 < x <= 1). Default is 0.15.
Ignored for Self-Prentice method.}

\item{method}{Weighting method: "Borgan1" (Borgan I), "Borgan2" (Borgan II), or
"SelfPrentice" (Self-Prentice). Default is "Borgan1".}

\item{type}{Task type: "right" for survival analysis with right-censored data,
or "mstate" for multi-state analysis. Default is "right".}

\item{censored_level}{For "mstate", the censored level in event_or_status. Default is first level.}
}
\value{
A numeric vector of weights. Rows with NA weights must be filtered before analysis (e.g., coxph).
}
\description{
This function calculates weights for a case-cohort study design using one of three methods:
Borgan I, Borgan II, or Self-Prentice. It supports survival analysis with right-censored data
or multi-state analysis.
}
\details{
\itemize{
\item \strong{Borgan I}: Weights subcohort censored subjects (or non-events) by \code{1/sampling_fraction},
all events (subcohort or not) by 1. Non-subcohort censored subjects are NA.
\item \strong{Borgan II}: Weights all subcohort members (censored or events) by \code{1/sampling_fraction},
non-subcohort events by 1. Non-subcohort censored subjects are NA.
\item \strong{Self-Prentice}: Weights all subcohort members and non-subcohort events by 1.
Non-subcohort censored subjects are NA. Sampling fraction is not used.
}
}
\examples{
# Right-censored survival examples:
df <- data.frame(subcoh = c(1, 0, 1, 0, 1, 0), 
                 event = c(0, 1, 1, 1, 0, 0))
w_b1 <- case_cohort_weights(df, "subcoh", "event", 0.15, "Borgan1", "right")
w_b2 <- case_cohort_weights(df, "subcoh", "event", 0.15, "Borgan2", "right")
w_sp <- case_cohort_weights(df, "subcoh", "event", 0.15, "SelfPrentice", "right")
print(w_b1)  # [6.666667, 1, 1, 1, 6.666667, NA]
print(w_b2)  # [6.666667, 1, 6.666667, 1, 6.666667, NA]
print(w_sp)  # [1, 1, 1, 1, 1, NA]

# Multi-state examples:
df_ms <- data.frame(subcoh = c(1, 0, 1, 0, 1, 0),
    status = factor(c('censored', 'main', 'competing', 'main', 'censored', 'censored')))
w_b1_ms <- case_cohort_weights(df_ms, "subcoh", "status", 0.15, "Borgan1", "mstate")
w_b2_ms <- case_cohort_weights(df_ms, "subcoh", "status", 0.15, "Borgan2", "mstate")
w_sp_ms <- case_cohort_weights(df_ms, "subcoh", "status", 0.15, "SelfPrentice", "mstate")
print(w_b1_ms)  # [6.666667, 1, 1, 1, 6.666667, NA]
print(w_b2_ms)  # [6.666667, 1, 6.666667, 1, 6.666667, NA]
print(w_sp_ms)  # [1, 1, 1, 1, 1, NA]

}
